/*
In order to create 'RuralKing-824' Import Map:
General>
Mapping ID:			RuralKing-824
Version:			5010
Tran Set:			824
Module:^			OM
Description:		RuralKing-824 - Application Advise
Customer:			10535
Trading Partner:^	Rural King
Mappings>
Root Insight Object: OMTRANSACTION
Add Root:: 
	General Tab>
	Level: Header
	Segment: BGN
	Segments Tab> Add Root:: BGN/OTI/TED
Insight Table(s): Add:: OMTRANSACTIONHEADER
	Operation: None
	Profile Usage: None
Mappings: Add:: R_NOTIFYPARTY	Lookup -->Header.RuralKing-824-EMAILHEADER.ROWID
	Lookups Tab> Add::824-EMAILHEADER
	Lookup Mappings: Add:: {} Source: {}
Add Root:: 
	General Tab>
	Level: Detail
	Segment: NTE
	Segments Tab> Add Root:: NTE
Insight Table(s): Add:: OMTRANSACTIONDETAIL
	Operation: None
	Profile Usage: None
Mappings: Add:: R_PARENTDETAIL	Lookup -->Detail.RuralKing-824-EMAILDETAIL.ROWID
	Lookups Tab> Add::824-EMAILDETAIL
	Lookup Mappings: Add:: {} Source: {}

Ideas:

1. Create some tables for Inbound EDI traffic to dump into when Users only need informed via email notification.
2. Build a brand new 824 Rural King map using these tables.
3. Build a brand new 812 Rural King map using these tables.
4. Test this process by importing test data to create records in these tables.
5. Create a report using these tables based upon document type.
6. It would be nice if we could use a single report and email list based upon document type.
7. Email list will be the issue here. See bottom for my attempt to set that up (would need Shelly added as a UserID)
8. TA would then need to use my solution for the email list.
9. Otherwise a separate TA needs created for each doctype. (812,820,824,864,895)

Need to seriously flesh out these tables and then get to building the maps.
Also need to start process of automation for Rural King.
Also need to prepare for/schedule EDI Sales team meeeting to seriously flesh out EDI IMPORT SPECIFICATION format.

Only then can I begin to start looking at SiteOne and TrueValue development. TrueValue is due in October so I am on the clock.

*/
--CREATE TABLES:
/*
DOCTYPE					824
DOCTYPEDESCRIPTION		Payment Order/Remittance Advice
IDGROUP					535
IDGROUPDESCRIPTION		Rural King
TRANSACTIONNUMBER		10-45775
PURCHASEORDERNUMBER		POB1X80156
STORENUMBER				99
GLN#					{NULL}
WAREHOUSEID				10
CUSTOMERID				10535
CONSIGNEEID				829254
VENDOR					80156
USERDEFINEDREFERENCE_10	EDI535

GNC_EDI_EMAILHEADER	(812,820,824,864,895)
	ROWID				UNIQUEIDENTIFIER	
	EMAILSENTFLAG		CHAR(1)				
	DOCTYPE				VARCHAR(4)				
	IDGROUP				VARCHAR(10)			
	WAREHOUSEID			VARCHAR(12)			
	TRANSACTIONNUMBER	VARCHAR(20)			
	PONUMBER			VARCHAR(20)			
	STORENUMBER			VARCHAR(50)			
	DATETIME			DATETIME			
	ACTION				VARCHAR(MAX)		
	REFERENCE			VARCHAR(MAX)		
	RESULT				VARCHAR(MAX)		
	IDENTIFIERS			VARCHAR(MAX)		
	SUBJECT				VARCHAR(MAX)		
GNC_EDI_EMAILDETAIL						
	R_HEADER			UNIQUEIDENTIFIER	
	LINENUMBER			INT					
	DETAIL				VARCHAR(MAX)		
*/

--GET DOCTYPEDESCRIPTION FROM DOCTYPE 
SELECT SETH.TRANSSETNAME 
FROM EDSETHEAD SETH (NOLOCK) 
WHERE SETH.TRANSSETID = '820' 

--GET GROUPDESCRIPTION FROM CUSTOMERID 
SELECT CUST.REFERENCE2 
FROM IDMASTER CUST (NOLOCK) 
WHERE CUST.IDENTITYID = '10535' 

--GET GROUPDESCRIPTION FROM IDGROUP 
SELECT REFERENCE2 
FROM IDMASTER CUST (NOLOCK) 
JOIN IDTYPESLINKS LINK (NOLOCK) ON LINK.R_IDENTITY = CUST.ROWID AND LINK.IDTYPE = '01' 
WHERE CUST.IDGROUP = '535' 

--GET CONSIGNEEID FROM STORENUMBER AND CUSTOMER IDGROUP
SELECT CONS.IDENTITYID, CONS.NAME 
FROM IDMASTER CUST (NOLOCK)
JOIN IDRELATIONSHIPLINKS RLINK (NOLOCK) ON RLINK.IDMASTERTYPE = '01' AND RLINK.IDMEMBERTYPE = '02' AND RLINK.R_IDMASTER = CUST.ROWID 
JOIN IDMASTER CONS (NOLOCK) ON CONS.ROWID = RLINK.R_IDMEMBER
JOIN IDCONSIGNEE ICONS (NOLOCK) ON ICONS.R_IDENTITY = CONS.ROWID 
WHERE CUST.IDGROUP = '535'
AND RIGHT('0000'+ICONS.USERDEFINEDREFERENCE_2,4) = RIGHT('0000'+'99',4)



/*
--824 Rural King=
ISA|00|          |00|          |ZZ|RKYORKT        |ZZ|GREENLEAFAS2   |230214|1335|U|00401|000000006|0|T|{~
GS|AG|RKYORKT|GREENLEAFAS2|20230214|1335|000000003|X|005010~
ST|824|000000003~
BGN|44|10-45775|20230214|1335||P978AD5Z~
OTI|TR|IV|10-45775|||||2|0002~
TED|024|Warning Error Code: E SegmentType: SAC~

NTE|GEN|Invalid indicator for allowance or charges (SAC-01). Must be 'A' or 'C'.~
NTE|GEN|Invalid Allowance/Charge Code (SAC-02) used for allowance/charge.~
NTE|GEN|SAC-05 Allowance/charge amount is 0.~

SE|8|000000003~
GE|1|000000003~
IEA|1|000000006~
DOCTYPE:	824
DOCTYPETEXT: APPLICATION ADVICE
IDGROUP:	535
GROUPNAME:	RURAL KING
ACTION:		44(REJECTED/FIX&RESEND) {45(WARNING/DONOTRESEND)}
REFERENCE:	10-45775
DATETIME:	2023/02/14:1335
RESULT:		TR-Transaction Set Reject {TA-Trans Set Accept/TE-Trans Set AcceptwError}
IDENTIFIERS: INVOICE#:10-45775 {PO#:POB1X80156/SHIPPER SID:1234/PO_PO#:POB1X80156}
SUBJECT:	024-General Reject Code: Warning Error Code: E SegmentType: SAC

DETAILS:	GEN: Invalid indicator for allowance or charges (SAC-01). Must be 'A' or 'C'.
			GEN: Invalid Allowance/Charge Code (SAC-02) used for allowance/charge.
			GEN: SAC-05 Allowance/charge amount is 0.
----------------------------------------------------------------------------------
--824 Kroger=
ISA*00*          *00*          *08*9254110060     *12*9184575172     *210827*1836*^*00501*100001099*0*P*>~
GS*AG*5137624388*9184575172*20210827*1836*100000000*X*005010~
ST*824*3157002~
BGN*00*03400038*20210827~
N1*TO*GREENLEAF NURSERY COMPANY INC*1*032992778~
N1*FR*THE KROGER CO.*1*099391542~
PER*IC*EDI.KROGER.COM OR EDI.INTER-AMERICANFOODS.COM~
OTI*TR*IV*Z.158825.1*****1669*0001*894~
TED*MD*E0903G8207INVLD INVC DATE; INVC DATE OLDER THAN 28 DAYS AGO*****20210327~
SE*8*3157002~
GE*1*100000000~
IEA*1*100001099~
DOCTYPE:	824
DOCTYPETEXT: APPLICATION ADVICE
IDGROUP:	129
GROUPNAME:	KROGER HOUSTON
ACTION:		REJECTED
REFERENCE:	Z.158825.1
DATETIME:	2021/08/27
RESULT:		TR-Transaction Set Reject {TA-Trans Set Accept/TE-Trans Set AcceptwError}
IDENTIFIERS: IV-Z.158825.1
SUBJECT:	MD-E0903G8207INVLD INVC DATE; INVC DATE OLDER THAN 28 DAYS AGO

DETAILS:	20210327
----------------------------------------------------------------------------------
--824 Lowes=
ISA*00*          *00*          *01*006097142      *12*9184575172     *210914*2230*U*00400*000086545*0*P*>\
GS*AG*006097142*9184575172*20210914*2230*322*X*004060\
ST*824*000006470\BGN*00*0170775802*20210914*2230*ET\N1*ST**94*002417\PER*BD*MERRXM4\
OTI*TE*PO*0170775802*9184575172*006097142*****855\REF*IX*0002861167\REF*WO*000004710\AMT*LI*27.96\AMT*Z7*27.92\
TED*ZZZ*PO ORIGINAL: MP COST USED - VENDOR HIGHER\
SE*11*000006470\
ST*824*000006471\BGN*00*0170775804*20210914*2230*ET\N1*ST**94*000653\PER*BD*MERRXM4\
OTI*TE*PO*0170775804*9184575172*006097142*****855\REF*IX*0000050088\REF*WO*000004710\AMT*LI*15.41\AMT*Z7*15.23\
TED*ZZZ*PO ORIGINAL: MP COST USED - VENDOR HIGHER\
SE*11*000006471\
ST*824*000006472\BGN*00*0170775804*20210914*2230*ET\N1*ST**94*000653\PER*BD*MERRXM4\
OTI*TE*PO*0170775804*9184575172*006097142*****855\REF*IX*0000097203\REF*WO*000004710\AMT*LI*14.88\AMT*Z7*14.7\
TED*ZZZ*PO ORIGINAL: MP COST USED - VENDOR HIGHER\
SE*11*000006472\
ST*824*000006473\BGN*00*0170775804*20210914*2230*ET\N1*ST**94*000653\PER*BD*MERRXM4\OTI*TE*PO*0170775804*9184575172*006097142*****855\
REF*IX*0000131338\REF*WO*000004710\AMT*LI*6.08\AMT*Z7*5.95\TED*ZZZ*PO ORIGINAL: MP COST USED - VENDOR HIGHER\SE*11*000006473\
ST*824*000006474\BGN*00*0170775804*20210914*2230*ET\N1*ST**94*000653\PER*BD*MERRXM4\OTI*TE*PO*0170775804*9184575172*006097142*****855\
REF*IX*0000131367\REF*WO*000004710\AMT*LI*19.1\AMT*Z7*19\TED*ZZZ*PO ORIGINAL: MP COST USED - VENDOR HIGHER\SE*11*000006474\
ST*824*000006475\BGN*00*0170775804*20210914*2230*ET\N1*ST**94*000653\PER*BD*MERRXM4\OTI*TE*PO*0170775804*9184575172*006097142*****855\
REF*IX*0000382420\REF*WO*000004710\AMT*LI*17.18\AMT*Z7*17\TED*ZZZ*PO ORIGINAL: MP COST USED - VENDOR HIGHER\SE*11*000006475\
ST*824*000006476\BGN*00*0170775804*20210914*2230*ET\N1*ST**94*000653\PER*BD*MERRXM4\OTI*TE*PO*0170775804*9184575172*006097142*****855\
REF*IX*0000442436\REF*WO*000004710\AMT*LI*12.33\AMT*Z7*12.15\TED*ZZZ*PO ORIGINAL: MP COST USED - VENDOR HIGHER\SE*11*000006476\
ST*824*000006477\BGN*00*0170775804*20210914*2230*ET\N1*ST**94*000653\PER*BD*MERRXM4\OTI*TE*PO*0170775804*9184575172*006097142*****855\
REF*IX*0000840517\REF*WO*000004710\AMT*LI*15.87\AMT*Z7*15.69\TED*ZZZ*PO ORIGINAL: MP COST USED - VENDOR HIGHER\SE*11*000006477\
ST*824*000006478\BGN*00*0170775804*20210914*2230*ET\N1*ST**94*000653\PER*BD*MERRXM4\OTI*TE*PO*0170775804*9184575172*006097142*****855\
REF*IX*0002861164\REF*WO*000004710\AMT*LI*16.68\AMT*Z7*16.5\TED*ZZZ*PO ORIGINAL: MP COST USED - VENDOR HIGHER\SE*11*000006478\
ST*824*000006479\BGN*00*0170775804*20210914*2230*ET\N1*ST**94*000653\PER*BD*MERRXM4\OTI*TE*PO*0170775804*9184575172*006097142*****855\
REF*IX*0002861167\REF*WO*000004710\AMT*LI*28.87\AMT*Z7*27.92\TED*ZZZ*PO ORIGINAL: MP COST USED - VENDOR HIGHER\SE*11*000006479\
ST*824*000006480\BGN*00*0170775804*20210914*2230*ET\N1*ST**94*000653\PER*BD*MERRXM4\OTI*TE*PO*0170775804*9184575172*006097142*****855\
REF*IX*0002887069\REF*WO*000004710\AMT*LI*16.68\AMT*Z7*16.5\TED*ZZZ*PO ORIGINAL: MP COST USED - VENDOR HIGHER\SE*11*000006480\
ST*824*000006481\BGN*00*0170775804*20210914*2230*ET\N1*ST**94*000653\PER*BD*MERRXM4\OTI*TE*PO*0170775804*9184575172*006097142*****855\
REF*IX*0002887070\REF*WO*000004710\AMT*LI*16.68\AMT*Z7*16.5\TED*ZZZ*PO ORIGINAL: MP COST USED - VENDOR HIGHER\SE*11*000006481\
GE*12*322\
IEA*1*000086545\
DOCTYPE:	824
DOCTYPETEXT: APPLICATION ADVICE
IDGROUP:	37
GROUPNAME:	LOWES
ACTION:		TR-REJECTED {TA-ACCEPTED/TE-ACCEPTED W/ERROR}
REFERENCE:	PO-0170775804:855
DATETIME:	2021/09/14:2230
RESULT:		SKU:97203 AMTLI-14.88 AMTZ7-14.7
IDENTIFIERS: STORE#2417 - WO:4710 BUYER-MERRXM4
SUBJECT:	PO ORIGINAL: MP COST USED - VENDOR HIGHER\
DETAILS:{null}
----------------------------------------------------------------------------------
--Sams
---------------------------------------------------------------------------------
---------------------------------------------------------------------------------
--864 HomeDepot<INACTIVE>=
ISA*00*          *00*          *14*0722717110100  *ZZ*GREENLEAFAS2   *051212*2119*|*00406*000000212*0*P*>~GS*TX*072271711*GREENLEAFAS2*20051212*2119*3*X*004060~ST*864*000000003~BMG*18*000266353~MIT*000266353**80*55~MSG*                         HOME DEPOT EDI INVOICE ERRORS      EDIT DATE:2005-12-12*NP~MSG*TXT NBR: 000266353                REPORTED TO:              EDIT TIME:21:06:45*SS~MSG*                         TRADING PARTNER NAME*SS~MSG*                             SENDER ID: INTERCHANGE REC*SS~MSG*        THE FOLLOWING INVOICES HAVE BEEN REJECTED DUE TO*DS~MSG*        VIOLATION(S) OF THE HOME DEPOT MAPPING SPECIFICATIONS.*SS~MSG*        YOU MUST CORRECT AND RETRANSMIT UTILIZING THE SAME INVOICE*SS~MSG*        NUMBER WITHIN 5 BUSINESS DAYS.  OTHERWISE, THESE REJECTED*SS~MSG*        INVOICES WILL BE DELETED FROM OUR SYSTEM AND WILL NOT BE*SS~MSG*        PAID.*SS~MSG*        IF YOU CANNOT CORRECT AND RETRANSMIT THE INVOICE(S) IN*DS~MSG*        ERROR, NOTIFY YOUR EDI PRODUCTION SUPPORT CONTACT OR CALL*SS~MSG*        THE EDI HOTLINE AT (770) 433-8211 EXTENSION 10036.*SS~MSG*  INVOICE NUMBER        E R R O R   M E S S A G E*DS~MSG*INVOICE#             ED18  INVALID ALLOWANCE/CHARGE AMOUNT RECEIVED*SS~MSG*INVOICE#             ED15  INVOICE AMOUNT OUT OF BALANCE*SS~SE*20*000000003~GE*1*3~IEA*1*000000212~
DOCTYPE:	864
DOCTYPETEXT: TEXT MESSAGE
IDGROUP:	
GROUPNAME:	
ACTION:		
REFERENCE:	
DATETIME:	
RESULT:		TR-Transaction Set Reject {TA-Trans Set Accept/TE-Trans Set AcceptwError}
IDENTIFIERS: 
SUBJECT:	

DETAILS:	

--864 Orscheln=
ISA*00*          *00*          *ZZ*ORSC0001       *12*9184575172     *220825*1634*U*00400*000005513*0*P*>~GS*TX*ORSC0001*9184575172*20220825*163416*67*X*004010~
ST*864*000000067~BMG*00*810 INVOICE REJECTED.~
N1*FR*ORSCHELN FARM & HOME SUPPLY~N1*TO*GREENLEAF NURSERY COMPANY~
REF*IA*67886~
REF*IV*Z.10-37829-20~
MIT*PLEASE CORRECT AND RESEND.*THIS DOCUMENT WILL NOT BE PROCESSED.~
MSG*ISA NBR: 000004229   GS NBR: 4229        ST NBR: 0001~
MSG*BIG04 ORDER NUMBER IS TOO LONG~
MSG*PO NBR: 8079589-20~
SE*11*000000067~GE*1*67~IEA*1*000005513~
DOCTYPE:	864
DOCTYPETEXT: TEXT MESSAGE
IDGROUP:	456
GROUPNAME:	ORSCHELN
ACTION:		PLEASE CORRECT AND RESEND.
REFERENCE:	IV-Z.10-37829-20
DATETIME:	2023/02/14:1335
RESULT:		810 INVOICE REJECTED.
IDENTIFIERS: VENDOR: 67886-WH10
SUBJECT:	THIS DOCUMENT WILL NOT BE PROCESSED.

DETAILS:	ISA NBR: 000004229   GS NBR: 4229        ST NBR: 0001
			BIG04 ORDER NUMBER IS TOO LONG
			PO NBR: 8079589-20

--864 Menards
ISA*03*GREEN077  *01*GREEN077  *01*006203210P     *12*9184575172     *221207*0834*U*00401*000000046*0*P*>~
GS*TX*006203210*9184575172*20221207*0834*33*X*004010~
ST*864*0001~BMG*18*34751~MIT*EFFI70941562*Invoice has been payment refused~
MSG*2nd refusal notice.~
MSG*Qty Invoiced does not equal Qty Received.~
MSG*Sku: 2629872 Sequence: 26~
MSG*Qty Invoiced: 15.000 does NOT match our Qty Received: 0.000~
MSG*Fax your authorization to deduct/credit memo or concerns to the Electronic Payment Issues Team at 715-876-5964.  Thank You~
MSG*Alternatively, an email can be sent to PRFresponse@menard-inc.com.  All Authorizations to deduct are final.~
SE*10*0001~GE*1*33~IEA*1*000000046~
DOCTYPE:	864
DOCTYPETEXT: TEXT MESSAGE
IDGROUP:	378
GROUPNAME:	MENARDS
ACTION:		18-34751 [DON'T KNOW WHAT THIS REPRESENTS UNTIL NEW SPEC IS RECEIVED]
REFERENCE:	EFFI70941562
DATETIME:	[TODAYSDATE?]
RESULT:		Invoice has been payment refused
IDENTIFIERS: 
SUBJECT:	

DETAILS:	2nd refusal notice.~
			Qty Invoiced does not equal Qty Received.~
			Sku: 2629872 Sequence: 26~
			Qty Invoiced: 15.000 does NOT match our Qty Received: 0.000~
			Fax your authorization to deduct/credit memo or concerns to the Electronic Payment Issues Team at 715-876-5964.  Thank You~
			Alternatively, an email can be sent to PRFresponse@menard-inc.com.  All Authorizations to deduct are final.~


--864 Sams (NO EXAMPLES)<--ONLY APPLIES TO WALMART?
ISA*00*          *00*          *08*925485US00     *08*048004GL       *221215*2309*:*00501*864110073*0*P*>~
GS*TX*925485US00*048004GL*20221215*2309*864110073*X*005010~
ST*864*0001~
BMG*00*THESE DOCUMENTS WILL NOT BE PROCESSED.*03~
N1*FR*Sam s Club #4839*UL*0078742000008~
N1*TO*GREENLEAF~
REF*IA*048004~
REF*IV*000000102996811~
MIT*PLEASE CORRECT AND RESEND.*THESE DOCUMENTS WILL NOT BE PROCESSED.*175*60~
MSG*SEGMENT      ELEMENT      ERROR*SS~
MSG*INVOICE NUMBER    PO NUMBER     ID        POS - REF      DATA                     COMMENTS*SS~
MSG*102996811   4177184295     BIG       001 - 555                               DUPLICATE INVOICE RECORD             PROD*SS~
SE*11*0001~
ST*864*0002~
BMG*00*THESE DOCUMENTS WILL NOT BE PROCESSED.*03~
N1*FR*Sam s Club #8263*UL*0078742000008~
N1*TO*GREENLEAF~REF*IA*048004~
REF*IV*000000102996816~
MIT*PLEASE CORRECT AND RESEND.*THESE DOCUMENTS WILL NOT BE PROCESSED.*175*60~
MSG*SEGMENT      ELEMENT      ERROR*SS~
MSG*INVOICE NUMBER    PO NUMBER     ID        POS - REF      DATA                     COMMENTS*SS~
MSG*102996816   4177184296     BIG       001 - 555                               DUPLICATE INVOICE RECORD             PROD*SS~
SE*11*0002~
GE*2*864110073~
IEA*1*864110073~
DOCTYPE:	864
DOCTYPETEXT: TEXT MESSAGE
IDGROUP:	356
GROUPNAME:	SAMS CLUB
ACTION:		PLEASE CORRECT AND RESEND.
REFERENCE:	000000102996811
DATETIME:	2022/12/15:2309[GS04:GS05]
RESULT:		THESE DOCUMENTS WILL NOT BE PROCESSED.
IDENTIFIERS: [MIGHT COULD RETRO-DECODE WH BASED OFF OF REFERENCE INVOICE#?]
SUBJECT:	THESE DOCUMENTS WILL NOT BE PROCESSED.

DETAILS:	SEGMENT      ELEMENT      ERROR
			INVOICE NUMBER    PO NUMBER     ID        POS - REF      DATA                     COMMENTS
			102996811   4177184295     BIG       001 - 555                               DUPLICATE INVOICE RECORD             PROD

----------------------------------------------------------------------------------
---------------------------------------------------------------------------------
--HomeDepot<INACTIVE>=
ISA*00*          *00*          *14*072271711USAP  *ZZ*INTERCHANGE REC*040825*1420*^*00406*000058160*0*P*:~
GS*RA*072271711USAP*APPLICATION REC*20040825*142011*40480*X*004060~
ST*820*0015~
BPR*I*31422.05*C*CHK*PBC~
TRN*1*2000002087~
CUR*BY*USD~
REF*ZZ*0000001234~
DTM*020*20040825~
N1*PE*SAMPLE VENDOR INC~
REF*VR*123456~
N1*PR*HOME DEPOT U.S.A., INC.~
ENT*1~
RMR*OS*01152312**-273.12*-273.12*0*CM*0~REF*RZ*72778~DTM*999*20040614~
RMR*OS*01449624**-576.73*-576.73*0*CM*0~REF*TN*BV2500RE~DTM*999*20040614~
RMR*OS*01590664**-462*-462*0*CM*0~REF*RZ*119741~DTM*999*20040614~
RMR*CM*0471012340**-51.05*-51.05*0*CM*0~REF*PO*0001312939~DTM*999*20040610~
RMR*CM*0471126257**-51.05*-51.05*0*CM*0~REF*ST*0001529177~DTM*999*20040610~
RMR*IV*10170895**97.43*99.42*1.99*PT*0~REF*PO*0000943963~DTM*999*20040517~
RMR*IV*10170951**79.44*81.06*1.62*PT*0~REF*PO*0000186405~DTM*999*20040520~
RMR*CM*1060007077**-45.95*-45.95*0*CM*0~REF*PO*0027470682~DTM*999*20040609~
RMR*CM*1070025083**-51.05*-51.05*0*CM*0~REF*PO*0002766369~DTM*999*20040609~
RMR*CM*1080001608**-51.05*-51.05*0*CM*0~REF*PO*0012176800~DTM*999*20040610~
RMR*CC*1080021650**-51.05*-51.05*0*CM*0~REF*FI*0009035908~DTM*999*20040610~
RMR*RV*11196326**43.01*43.89*.88*PT*0~REF*MC*0000059925~DTM*999*20040520~
RMR*IV*11196335**67.74*69.12*1.38*PT*0~REF*PO*0000060159~DTM*999*20040520~
RMR*IV*11196369**62.09*63.36*1.27*PT*0~REF*PO*0000068639~DTM*999*20040520~
RMR*CM*1600028962**-95.88*-95.88*0*CM*0~REF*PO*0001643990~DTM*999*20040608~
RMR*CM*1640075563**-51.05*-51.05*0*CM*0~REF*PO*0022077981~DTM*999*20040611~
RMR*IV*17245635**46.29*47.23*.94*PT*0~REF*BM*0000582280~DTM*999*20040517~
RMR*IV*17245710**100.35*102.4*2.05*PT*0~REF*PO*0000579806~DTM*999*20040521~
RMR*CM*2636604713**-59.38*-59.38*0*CM*0~REF*PO*0001020599~DTM*999*20040615~
RMR*CM*3380088409**-69.57*-69.57*0*CM*0~REF*PO*0001611793~DTM*999*20040607~
RMR*CM*40684148**-77.6*-77.6*0*CM*0~REF*PO*0062330640~DTM*999*20040610~
RMR*CM*45120543**-96.54*-96.54*0*CM*0~REF*PO*0000000000~DTM*999*20040611~
RMR*CM*456981182**-118.47*-118.47*0*CM*0~REF*PO*0065054407~DTM*999*20040604~
RMR*NB*4676811**70.8*70.8*0*PT*0~REF*CR*0000902809~DTM*999*20040306~
RMR*CM*5015074583**-117.7*-117.7*0*CM*0~REF*PO*0010109554~DTM*999*20040610~
RMR*CM*5015508097**-66.37*-66.37*0*CM*0~REF*PO*0006487289~DTM*999*20040611~
RMR*CM*5025178347**-66.37*-66.37*0*CM*0~REF*PO*0006738101~DTM*999*20040610~
RMR*CM*5025185568**-66.37*-66.37*0*CM*0~REF*PO*0010539012~DTM*999*20040610~
RMR*IV*9401006726**1845.12*1882.78*37.66*PT*0~REF*PO*0013947261~DTM*999*20040519~
RMR*IV*9401010244**13051.64*13318*266.36*PT*0~REF*PO*0073677673~DTM*999*20040519~
RMR*IV*9401017641**1379.98*1408.14*28.16*PT*0~REF*PO*0013028290~DTM*999*20040520~
RMR*IV*9401018108**251.43*256.56*5.13*PT*0~REF*PO*0041843926~DTM*999*20040521~
RMR*IV*9401018357**251.1*256.22*5.12*PT*0~REF*PO*0072875454~DTM*999*20040521~
RMR*IV*9401023033**250.74*255.86*5.12*PT*0~REF*PO*0075640672~DTM*999*20040521~
RMR*IV*9401025768**254.8*260*5.2*PT*0~REF*PO*0013940530~DTM*999*20040522~
RMR*IV*9401026293**6121.91*6246.85*124.94*PT*0~REF*PO*0085600928~DTM*999*20040522~
RMR*IV*9401089369**9946.54*10149.53*202.99*PT*0~REF*PO*0075680484~DTM*999*20040608~
RMR*CM*9401089733**-.01*-.01*0*CM*0~NTE*AFA*TRADE DISCOUNT~REF*PO*0073714072~DTM*999*20040608~
SE*126*0015~GE*1*40480~IEA*1*000058160~
DOCTYPE:	820
DOCTYPETEXT: Payment Order/Remittance Advice
IDGROUP:	
GROUPNAME:	
ACTION:		
REFERENCE:	
DATETIME:	
RESULT:		
IDENTIFIERS: 
SUBJECT:	

DETAILS:	
			
			
--820 Aafes(NO EXAMPLES)
----------------------------------------------------------------------------------
---------------------------------------------------------------------------------
--895 Kroger=
ISA*00*          *00*          *08*9254110060     *12*9184575172     *210409*0202*^*00501*100000942*0*P*>~
GS*DX*5137624388*9184575172*20210409*0202*100000031*X*005010~
ST*895*0001~
G87*R*D*Z.158861.2*0129*1~
G88*20210408~
LS*0100~
G89*6*0**000877658967~
G89*10*0**000877665285~
LE*0100~
G84*133*92780~
G86*A576~
G85*A4D9~
SE*11*0001~
ST*895*0002~G87*R*D*Z.158809.2*0129*1~G88*20210408~LS*0100~G89*3*0**000877658967~LE*0100~G84*250*183100~G86*EFF7~G85*A955~SE*10*0002~
ST*895*0003~G87*R*D*Z.158836.2*0129*1~G88*20210408~LS*0100~G89*1*0**000877658967~G89*3*25*EA*000877662453~LE*0100~G84*210~G86*A8C7~G85*829C~SE*11*0003~
ST*895*0004~G87*R*D*Z.158819.2*0129*1~G88*20210408~LS*0100~G89*1*0**000877658967~G89*5*35*EA*000877664970~LE*0100~G84*265~G86*13F6~G85*9907~SE*11*0004~
ST*895*0005~G87*R*D*Z.158844.2*0129*1~G88*20210408~LS*0100~G89*2*0**000877658967~G89*6*0**000877665523~G89*8*40*EA*000877662453~LE*0100~G84*210~G86*1C67~G85*1197~SE*12*0005~
ST*895*0006~G87*R*D*Z.158794.2*0129*1~G88*20210408~LS*0100~G89*4*0**000877658967~LE*0100~G84*250*183100~G86*B131~G85*4A8F~SE*10*0006~
ST*895*0007~G87*R*D*Z.158812.2*0129*1~G88*20210408~LS*0100~G89*4*0**000877658967~G89*8*30*EA*000877662453~LE*0100~G84*265~G86*D187~G85*9E38~SE*11*0007~
ST*895*0008~G87*R*D*Z.158864.2*0129*1~G88*20210408~LS*0100~G89*2*0**000877658967~G89*3*20*EA*000877662453~LE*0100~G84*140~G86*A466~G85*F390~SE*11*0008~
ST*895*0009~G87*R*D*Z.158871.2*0129*1~G88*20210408~LS*0100~G89*2*0**000877658967~G89*4*0**000877665523~LE*0100~G84*180*128000~G86*5977~G85*75ED~SE*11*0009~
ST*895*0010~G87*R*D*Z.158874.2*0129*1~G88*20210408~LS*0100~G89*6*0**000877658967~G89*8*20*EA*000877663505~LE*0100~G84*140*94500~G86*5867~G85*16BB~SE*11*0010~
ST*895*0011~G87*R*D*Z.158817.2*0129*1~G88*20210408~LS*0100~G89*6*0**000877658967~LE*0100~G84*250*183100~G86*D097~G85*2B9B~SE*10*0011~
ST*895*0012~G87*R*D*Z.158848.2*0129*1~G88*20210408~LS*0100~G89*2*0**000877665523~G89*3*40*EA*000877662453~G89*7*0**000877658967~LE*0100~G84*210~G86*1FA7~G85*A153~SE*12*0012~
ST*895*0013~G87*R*D*Z.158882.2*0129*1~G88*20210408~LS*0100~G89*3*0**000877658967~G89*4*0**000877665285~G89*7*25*EA*000877662453~LE*0100~G84*145~G86*4D84~G85*A751~SE*12*0013~
ST*895*0014~G87*R*D*Z.158857.2*0129*1~G88*20210408~LS*0100~G89*3*0**000877665523~G89*8*0**000877658967~LE*0100~G84*180*128000~G86*E096~G85*69A3~SE*11*0014~
ST*895*0015~G87*R*D*Z.158853.2*0129*1~G88*20210408~LS*0100~G89*2*0**000877665523~G89*7*0**000877658967~LE*0100~G84*180*128000~G86*21D7~G85*85AF~SE*11*0015~
ST*895*0016~G87*R*D*Z.158890.2*0129*1~G88*20210408~LS*0100~G89*6*0**000877658967~LE*0100~G84*180*128000~G86*7124~G85*D1A9~SE*10*0016~
ST*895*0017~G87*R*D*Z.158878.2*0129*1~G88*20210408~LS*0100~G89*5*0**000877658967~G89*6*20*EA*000877663505~LE*0100~G84*140*94500~G86*5BA7~G85*B097~SE*11*0017~
ST*895*0018~G87*R*D*Z.159188.1*0129*1~G88*20210408~LS*0100~G89*3*0**000877658967~LE*0100~G84*195*142400~G86*9E39~G85*C907~SE*10*0018~
ST*895*0019~G87*R*D*Z.158879.2*0129*1~G88*20210408~LS*0100~G89*2*0**000877658967~LE*0100~G84*130*89900~G86*9BF6~G85*D39D~SE*10*0019~
ST*895*0020~G87*R*D*Z.158869.2*0129*1~G88*20210408~LS*0100~G89*1*0**000877658967~G89*4*21*EA*000877662453~G89*7*0**000877665285~LE*0100~G84*141~G86*67F7~G85*DC70~SE*12*0020~
ST*895*0021~G87*R*D*Z.158856.2*0129*1~G88*20210408~LS*0100~G89*5*20*EA*000877662453~G89*7*0**000877658967~LE*0100~G84*140~G86*20C7~G85*F1C9~SE*11*0021~
ST*895*0022~G87*R*D*Z.158880.2*0129*1~G88*20210408~LS*0100~G89*3*0**000877665523~G89*4*0**000877658967~LE*0100~G84*135*94700~G86*8D25~G85*B5D0~SE*11*0022~
ST*895*0023~G87*R*D*Z.158829.2*0129*1~G88*20210408~LS*0100~G89*7*30*EA*000877664970~G89*8*0**000877658967~LE*0100~G84*210~G86*57F6~G85*8180~SE*11*0023~
ST*895*0024~G87*R*D*Z.158885.2*0129*1~G88*20210408~LS*0100~G89*2*0**000877665523~G89*4*20*EA*000877664970~G89*10*0**000877658967~LE*0100~G84*150~G86*8C35~G85*8404~SE*12*0024~
ST*895*0025~G87*R*D*Z.158870.2*0129*1~G88*20210408~LS*0100~G89*1*21*EA*000877662453~G89*2*0**000877665285~G89*3*0**000877658967~LE*0100~G84*141~G86*9926~G85*18A2~SE*12*0025~
GE*25*100000031~IEA*1*100000942~

DOCTYPE:	895
DOCTYPETEXT: DELIVERY ACKNOWLEDGMENT
IDGROUP:	129
GROUPNAME:	KROGER HOUSTON
ACTION:		
REFERENCE:	Z.158861.2
DATETIME:	2021/04/08
RESULT:		COUNT:133 INVOICE TOTAL:92780
IDENTIFIERS: WH:20
SUBJECT:	

DETAILS:	LINE#6	QTY:0 UPC:000877658967 {PRICE:[G8908 IS ACCEPTED PRICE IF DIFFERENT OTHERWISE BLANK]}
			LINE#10	QTY:0 UPC:000877665285 {PRICE:[G8908 IS ACCEPTED PRICE IF DIFFERENT OTHERWISE BLANK]}
----------------------------------------------------------------------------------
----------------------------------------------------------------------------------
--812 Rural King=
ISA|00|          |00|          |ZZ|RKYORKT        |ZZ|GREENLEAFAS2   |230216|1412|U|00401|000000018|0|T|{~
GS|CD|RKYORKT|GREENLEAFAS2|20230216|1412|000000002|X|005010~
ST|812|000000002~
BCD|20230216|998877665|T|31903|C||INV_34567|||CMC1X80156||CR|PD|12345~
CUR|BY|USD~
N9|IA|80156~
ITD||||||20230318||||||NET30|~
SAC|C|H850|||2783||||||||||~
N1|ST|SHIP TO COMPANY|92|46~
N3|123 MANDALAY DRIVE|SUITE 1~
N4|KALAMAZOO|MI|49009~

CDD|A5|C|||||4|EA||UCP|18.20~
LIN|1|IN|801560155|UP|008776142313|VN|001884.031.1~
N9|L1||Defective Units Received~

CDD|A5|C|||||4|EA||UCP|18.20~
LIN|2|IN|801560194|UP|008776137487|VN|003150.031.1~
N9|L1||Defective Units Received~

CDD|A5|C|||||4|EA||UCP|18.20~
LIN|3|IN|801560195|UP|008776137494|VN|004102.031.1~
N9|L1||Defective Units Received~

CDD|A5|C|||||4|EA||UCP|18.20~
LIN|4|IN|801560015|UP|008776207661|VN|006411.031.1~
N9|L1||Defective Units Received~

SE|22|000000002~
GE|1|000000002~
IEA|1|000000018~
DOCTYPE:	812
DOCTYPETEXT: CREDIT DEBIT ADJUSTMENT
IDGROUP:	535
GROUPNAME:	RURAL KING
ACTION:		T-CREATE & SEND 810 {H-NOTIFICATION, DO NOT SEND 810}
REFERENCE:	998877665
DATETIME:	2023/02/16
RESULT:		C-Credit {D-Debit} Total Amount: 31903 (H850-Taxes = 2783)
IDENTIFIERS: INVOICE#:10-45775 PO#:POB1X80156
SUBJECT:	CR-Credit Memo {DR-Debit Memo/RA-CrNoteRequest} PD-Promo/Deal {1X-CrDbAdj#} 12345

DETAILS:	A5-Overage, Credit{Debit} 4 EA @ 18.20 LINE#: 1 SKU:801560155 UPC:008776142313 ITEM:001884.031.1>> Defective Units Received
			A5-Overage, Credit{Debit} 4 EA @ 18.20 LINE#: 2 SKU:801560194 UPC:008776137487 ITEM:003150.031.1>> Defective Units Received
			A5-Overage, Credit{Debit} 4 EA @ 18.20 LINE#: 3 SKU:801560195 UPC:008776137494 ITEM:004102.031.1>> Defective Units Received
			A5-Overage, Credit{Debit} 4 EA @ 18.20 LINE#: 4 SKU:801560015 UPC:008776207661 ITEM:006411.031.1>> Defective Units Received
----------------------------------------------------------------------------------
--812 Sams(NO EXAMPLES)<--ONLY APPLIES TO WALMART?

*/


/* 
SELECT DOCTYPE, METHOD, IDENTITYID, NAME, EMAILADDRESS_1
FROM (
		SELECT '812' AS DOCTYPE, 'TO' AS METHOD, USR.IDENTITYID, USR.NAME, ADDR.EMAILADDRESS_1
		FROM IDMASTER USR (NOLOCK)
		JOIN IDABECASUSERIDS IUSR (NOLOCK) ON IUSR.R_IDENTITY = USR.ROWID
		JOIN IDADDRESS ADDR (NOLOCK) ON ADDR.ROWID = USR.R_DEFAULTADDRESS
		WHERE USR.NAME 
		IN ('Carin Hodson')
		UNION
		SELECT '820', 'TO', USR.IDENTITYID, USR.NAME, ADDR.EMAILADDRESS_1
		FROM IDMASTER USR (NOLOCK)
		JOIN IDABECASUSERIDS IUSR (NOLOCK) ON IUSR.R_IDENTITY = USR.ROWID
		JOIN IDADDRESS ADDR (NOLOCK) ON ADDR.ROWID = USR.R_DEFAULTADDRESS
		WHERE USR.NAME 
		IN ('Carin Hodson', 
			'Roberta Kimble', 
			'Shelly Cerny', 
			'Starla Kimble'
			)
		UNION
		SELECT '824', 'TO', USR.IDENTITYID, USR.NAME, ADDR.EMAILADDRESS_1
		FROM IDMASTER USR (NOLOCK)
		JOIN IDABECASUSERIDS IUSR (NOLOCK) ON IUSR.R_IDENTITY = USR.ROWID
		JOIN IDADDRESS ADDR (NOLOCK) ON ADDR.ROWID = USR.R_DEFAULTADDRESS
		WHERE USR.NAME 
		IN ('Carin Hodson',
			'Cindy Hendrix',
			'David Brandt',
			'Erica Washington',
			'Jeremy Clark',
			'Lisa Baker',
			'Starla Kimble',
			'Stephanie Knight',
			'Valerie Woodruff'
			)
		UNION
		SELECT '864', 'TO', USR.IDENTITYID, USR.NAME, ADDR.EMAILADDRESS_1
		FROM IDMASTER USR (NOLOCK)
		JOIN IDABECASUSERIDS IUSR (NOLOCK) ON IUSR.R_IDENTITY = USR.ROWID
		JOIN IDADDRESS ADDR (NOLOCK) ON ADDR.ROWID = USR.R_DEFAULTADDRESS
		WHERE USR.NAME 
		IN ('Carin Hodson',
			'Cindy Hendrix',
			'David Brandt',
			'Erica Washington',
			'Jeremy Clark',
			'Lisa Baker',
			'Starla Kimble',
			'Stephanie Knight',
			'Valerie Woodruff'
			)
		UNION
		SELECT '895', 'TO', USR.IDENTITYID, USR.NAME, ADDR.EMAILADDRESS_1
		FROM IDMASTER USR (NOLOCK)
		JOIN IDABECASUSERIDS IUSR (NOLOCK) ON IUSR.R_IDENTITY = USR.ROWID
		JOIN IDADDRESS ADDR (NOLOCK) ON ADDR.ROWID = USR.R_DEFAULTADDRESS
		WHERE USR.NAME 
		IN ('Bill Davenport',
			'Carin Hodson',
			'Cindy Hendrix',
			'David Brandt',
			'Jeremy Clark',
			'Valerie Woodruff'
			)
		UNION
		SELECT '850', 'TO', USR.IDENTITYID, USR.NAME, ADDR.EMAILADDRESS_1
		FROM IDMASTER USR (NOLOCK)
		JOIN IDABECASUSERIDS IUSR (NOLOCK) ON IUSR.R_IDENTITY = USR.ROWID
		JOIN IDADDRESS ADDR (NOLOCK) ON ADDR.ROWID = USR.R_DEFAULTADDRESS
		WHERE USR.NAME 
		IN ('Angela Harrison',
			'Carin_Hodson',
			'Cindy Hendrix',
			'David Brandt',
			'Erica Washington',
			'Jeremy Clark',
			'Katherine Kessler',
			'Lisa Baker',
			'Sandra Epperley',
			'Starla_Kimble',
			'Stephanie Knight',
			'Valerie Woodruff'
			)
		UNION
		SELECT '850', 'CC', USR.IDENTITYID, USR.NAME, ADDR.EMAILADDRESS_1
		FROM IDMASTER USR (NOLOCK)
		JOIN IDABECASUSERIDS IUSR (NOLOCK) ON IUSR.R_IDENTITY = USR.ROWID
		JOIN IDADDRESS ADDR (NOLOCK) ON ADDR.ROWID = USR.R_DEFAULTADDRESS
		WHERE USR.NAME 
		IN ('Stephen Anderson')
) X
ORDER BY X.DOCTYPE, X.METHOD, X.NAME
*/